# 函数上下文

函数中可以使用this关键字，它表示函数的上下文。

this是在运行时进行绑定的，并不是在编写时绑定，它的上下文取决于函数调用时的各种条件。this的绑定和函数声明的位置没有任何关系，只取决于函数的调用方式。

当函数没有被调用，则无法确定其上下文。

## 绑定规则

函数的调用方式决定了this的绑定对象。

### 默认绑定

默认绑定是独立调用函数，如果在浏览器环境下使用这种调用方式，在非严格模式下，函数的上下文是window全局对象；在严格模式下，函数上下文是undefined。

### 隐式绑定



### 判定规则

判定规则中的函数不能是Lambda表达式。

1. 对象打点调用它的方法函数，则函数的上下文是这个打点的对象
2. 如果在浏览器中执行，圆括号直接调用函数，在非严格模式下，函数的上下文是window全局对象；在严格模式下，函数上下文是undefined
3. 数组（类数组对象)枚举出函数进行调用，上下文是这个数组（类数组对象)
4. IIFE中的函数，上下文是window对象
5. 定时器、延时器调用函数，上下文是window对象
6. 事件处理函数的上下文是绑定事件的DOM元素

如果内层函数需要使用外层函数的上下文，需要将上下文赋值给变量达到备份上下文的作用。

### 指定函数上下文

call和apply能够指定函数上下文。使用方法func.call(context)、func.apply(context)

#### call和apply的区别

如果函数有参数，调用call和apply传递参数的方法不同。call需要用逗号罗列参数，apply要把参数写到数组中。

### new操作符调用函数

JS规定，使用new操作符调用函数，函数内的上下文是新创建的对象，过程有以下四步：

1. 函数体内会自动创建出一个空白对象
2. 函数的上下文 (this）会指向这个对象
3. 函数体内的语句会执行
4. 函数会自动返回上下文对象，即使函数没有return语句

